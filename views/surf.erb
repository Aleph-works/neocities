<!doctype html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <% if @title %>
      <title><%= @title %> - Neocities</title>
    <% else %>
      <title>Neocities</title>
    <% end %>
    <link href="/css/font-awesome.css" rel="stylesheet">
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <style>
    * {
      margin: 0;
      padding: 0;
    }
    html {
      height: 100%; 
    }
    body {
      height: 100%;
      width: 100%;
      font-family: "Lucida Grande", helvetica, verdana, sans-serif;
      font-size: 12px;
      overflow: hidden;
    }
    #logo {
      background: url(/img/topbar-cat.png) no-repeat 1px -1px;
      width: 30px;
      height: 29px;
      position: absolute;
      display: block;
    }
    #website-frame {
      width: 100%;
      height: 100%;
    }
    #top-bar {
      background: #3B3B3B;
      color: #cecece;
      float: left;
      width: 100%;
      padding: 6px 0;
    }
    #top-bar ul {
      list-style: none;
    }
    #top-bar li {
      float: left;
      margin-left: 20px;  
    }
    #top-bar a {
      color: #cecece;
      text-decoration: none;
    }
    #top-bar a:hover {
      color: #fff;
    }
    #top-bar input {
      border: 0;
      background: #555;
      color:white;
      width: 120px;
      padding: 1px 5px;
      
    }
    ::-webkit-input-placeholder { font-style: italic; }
    :-moz-placeholder { font-style: italic; }
    ::-moz-placeholder { font-style: italic; }
    :-ms-input-placeholder { font-style: italic; }
    #top-bar .browse-actions {
      margin-left: 20px;
    }
    #top-bar .site-actions {
      float: right;
      margin-right: 9px;
    }
    #top-bar .close {
      background: url(/img/topbar-close.png) no-repeat;
      width: 13px;
      height: 13px;
      background-size: 13px;
      margin-top: 1px;
      float: left;
    }
    #top-bar .invisible a {
      color: #3B3B3B;
    }
    </style>
  </head>
  <body>
  <script type="text/javascript">
    function getPage(currentPage) {
      document.location.href = '/surf?current_page='+currentPage+'&'+$('#search_criteria').serialize()
    }

    function backToBrowse() {
      document.location.href = '/browse?'+$('#search_criteria').serialize()
    }
  </script>
  <a href="/" id="logo"></a>
  <div id="top-bar">
    <ul class="browse-actions">
      <li>
        <a href="/browse" onclick="backToBrowse(<%= @current_page %>); return false">Neocities</a>
      </li>
      <% if @current_page %>
        <li>
          <form id="search_criteria" onsubmit="getPage(1); return false">
            <input type="hidden" name="sort_by" value="<%= params[:sort_by] %>">
            <input class="typeahead" name="tag" type="text" placeholder="Browse by tag..." value="<%= params[:tag] %>" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" dir="auto" />
          </form>
        </li>
        <li>
          <% if @current_page > 1 %>
            <a href="" onclick="getPage(<%= @current_page - 1 %>); return false">
              <i class="fa fa-caret-left"></i> Prev
            </a>
          <% end %>
        </li>
        <li>
          <% if @current_page != @page_count %>
            <a href="" onclick="getPage(<%= @current_page + 1 %>); return false">Next <i class="fa fa-caret-right"></i></a>
          <% end %>
        </li>
      <% end %>
    </ul>
    <ul class="site-actions">
      <li><a href="/site/<%= @site.username %>"><i class="fa fa-user"></i> <strong><%= @site.username %></strong></a></li>
      <li><a href=""><i class="fa fa-plus"></i> Follow</a></li>
      <li>
        <a href="" id="shareButton" data-container="body" data-toggle="popover" data-placement="bottom" data-content='<%== erb :'_share', layout: false, locals: {site: @site} %>' onclick="return false">
          <i class="fa fa-share-alt"></i> Share
        </a>
      </li>
      <li><a class="close" href="//<%= @site.host %>" alt="close" title="close"></a></li>
    </ul>
  
  </div>
  <iframe src="//<%= @site.host %>" frameborder="0" scrolling="yes" marginheight="0" marginwidth="0" id="website-frame" name="website-frame"></iframe>

  <script src="/js/jquery-1.11.0.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/typeahead.bundle.js"></script>
  <script>
    $(function() {
      $('#shareButton').popover({html: true})
    })

    $('.typeahead').typeahead({
      minLength: 2,
      highlight: true
    }, {
      name: 'tags',
      source: function(query, callback) {
        $.get('/tags/autocomplete/'+query+'.json', function(data) {
          var suggestions = JSON.parse(data)
          var suggestionObjects = []
          for(var i=0; i<suggestions.length; i++)
            suggestionObjects.push({value: suggestions[i]})

          callback(suggestionObjects)
        })
      }
    })
  </script>
  </body>
</html>